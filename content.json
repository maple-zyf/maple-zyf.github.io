[{"title":"从grub-rescue恢复并配置启动本地ISO","date":"2016-07-06T16:00:00.000Z","path":"2016/07/07/grub-recovery-Note/","text":"&#x4FEE;&#x590D;grub &#x91CD;&#x88C5;&#x7CFB;&#x7EDF;&#x6216;&#x4ECE;&#x5907;&#x4EFD;&#x4E2D;&#x6062;&#x590D;&#x7CFB;&#x7EDF;&#x5BFC;&#x81F4;grub&#x51FA;&#x9519;&#xFF0C;&#x5F00;&#x673A;&#x8FDB;&#x5165;&#x4E0D;&#x4E86;&#x7CFB;&#x7EDF;&#x548C;&#x6B63;&#x5E38;&#x7684;grub&#x754C;&#x9762;. &#x5F00;&#x673A;&#x65F6;&#x663E;&#x793A;: error:unknow filesystem grub rescue&gt; &#x89E3;&#x51B3;&#x65B9;&#x6CD5; &#x7528;ls&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x5206;&#x533A;&#xFF0C;&#x7531;grub rescue&gt;&#x6062;&#x590D;&#x5230;grub&gt; grub rescue&gt;ls (hd0) (hd0,msdos9) (hd0,msdos8) (hd0,msdos7) (hd0,msdos6) (hd0,msdos5) (hd0,msdos1) //&#x54EA;&#x4E2A;&#x662F;&#x4F60;&#x7684;&#x7CFB;&#x7EDF;&#x76D8;&#x5462;&#xFF1F;&#x3000;&#x8FD9;&#x4E2A;&#x8981;&#x8BD5;&#x8BD5;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;Tab&#x8865;&#x5168;&#x6765;&#x770B;&#x770B;&#x6587;&#x4EF6;&#xFF0C;&#x4ECE;&#x800C;&#x627E;&#x5230;&#x6B63;&#x786E;&#x7684;&#x76D8;&#x53F7;. grub rescue&gt;set root=(hd0,msdos7) grub rescue&gt;set prefix=(hd0,msdos7)/boot/grub grub rescue&gt;insmod /boot/grub/i386-pc/normal.mod //&#x542F;&#x52A8;normal&#x542F;&#x52A8; &#x4EE5;&#x4E0A;&#x547D;&#x4EE4;&#x6B63;&#x786E;&#x5219;&#x4E0B;&#x4E00;&#x884C;&#x547D;&#x4EE4;&#x4F1A;&#x53D8;&#x4E3A;&#x9AD8;&#x4EAE; grub rescue&gt;normal &#x6B64;&#x65F6;&#x8FDB;&#x5165;grub&#x83DC;&#x5355;&#xFF0C;&#x4F46;&#x65E0;&#x6CD5;&#x8FDB;&#x5165;&#x4EFB;&#x4F55;&#x7CFB;&#x7EDF;&#x3002; &#x8FD9;&#x65F6;&#xFF0C;&#x8981;&#x7528;&#x547D;&#x4EE4;&#x8FDB;&#x5165;&#x4E00;&#x4E2A;&#x5B58;&#x5728;&#x7684;linux&#x7CFB;&#x7EDF;: &#x6309;c&#x952E;&#x8FDB;&#x5165;&#x547D;&#x4EE4;&#x6307;&#x793A;&#x7B26;&#x6A21;&#x5F0F; grub &gt;set root=hd0,msdos7 grub &gt;set prefix=(hd0,msdos7)/boot/grub grub &gt;linux /vmlinuz-xxx-xxx root=/dev/sda7 //&#x91CC;&#x8FB9;&#x7684;xxxx&#x53EF;&#x4EE5;&#x6309;Tab&#x952E;&#xFF0C;&#x5982;&#x679C;&#x6709;acpi&#x95EE;&#x9898;,&#x5728;&#x6700;&#x540E;&#x52A0;&#x4E00;&#x53E5;acpi=off grub &gt;initrd /initrd.img-xxx-xxx grub &gt;boot &#x6B64;&#x4EE5;&#x6210;&#x529F;&#x542F;&#x52A8;linux&#x3002; &#x5728;&#x7EC8;&#x7AEF;&#x91CC;&#x8FD0;&#x884C; sudo update-grub //&#x7528;&#x8FD9;&#x4E2A;&#x547D;&#x4EE4;,&#x4E0D;&#x8981;&#x518D;&#x7528; grub-mkconfig&#x4E86;(&#x603B;&#x51FA;&#x4E9B;/sda3 /sda6&#x5206;&#x4E0D;&#x6E05;&#x695A;&#x7684;&#x95EE;&#x9898;). &#x91CD;&#x5EFA;grub&#x5230;&#x7B2C;&#x4E00;&#x786C;&#x76D8;mbr sudo grub-install /dev/sda &#x7528;grub&#x76F4;&#x63A5;&#x542F;&#x52A8;iso&#x955C;&#x50CF; step1: debian&#x4E0A;&#x5B89;&#x88C5;grub-imageboot( &#x4F1A;&#x81EA;&#x52A8;&#x751F;&#x6210;&#x4E00;&#x4E2A;/boot/memdisk ) &#x6216;&#x8005;&#x662F;&#x4E0B;&#x8F7D;syslinux&#x5305; &#x627E;&#x5230;&#x91CC;&#x8FB9;&#x7684;memdisk&#x590D;&#x5236;&#x5230;/boot step2: &#x5728;/etc/grub.d/40custom &#x6DFB;&#x52A0;&#xFF1A; &#x4E0B;&#x8FB9;&#x662F;&#x6211;&#x81EA;&#x5DF1;&#x7684;&#x914D;&#x7F6E;&#xFF0C;&#x56E0;&#x4E3A;memdisk&#x5728;sda3, &#x800C;iso&#x6587;&#x4EF6;&#x5728;sda1. menuentry &quot;Load Rescue.iso&quot; { echo &apos;Loading Memdisk...&apos; linux16 (hd0,3)/boot/memdisk iso raw echo &apos;Loading ISO...&apos; initrd16 (hd0,6)/zengyingfeng/c_language/linux_C/ISO/Rescue.iso } menuentry &quot;Load ubuntu-live.iso&quot; { set root=(hd0,6) loopback loop /zengyingfeng/c_language/linux_C/ISO/ubuntu-12.04.4-desktop-i386.iso linux (loop)/casper/vmlinuz boot=casper iso-scan/filename=/zengyingfeng/c_language/linux_C/ISO/ubuntu-12.04.4-desktop-i386.iso initrd (loop)/casper/initrd.lz } step3: &#x7528;grub&#x5C06;&#x65B0;&#x7684;&#x914D;&#x7F6E;&#x5199;&#x5165;MBR sudo update-grub Found memdisk: /boot/memdisk Imagepath /boot/images not found done //&#x8FD9;&#x6837;&#x7684;&#x56DE;&#x663E;&#x662F;&#x6B63;&#x5E38;&#x7684;","tags":[{"name":"linux","slug":"linux","permalink":"http://maple-zyf.github.io/tags/linux/"},{"name":"grub","slug":"grub","permalink":"http://maple-zyf.github.io/tags/grub/"}]},{"title":"用外接鼠标的插拨来自动禁启用触摸板","date":"2016-07-06T16:00:00.000Z","path":"2016/07/07/touchpadDisable-Note/","text":"Touchpad Problems debian&#x4E0B;&#x6BCF;&#x6B21;&#x5F00;&#x673A;&#x89E6;&#x6478;&#x677F;&#x90FD;&#x662F;&#x9ED8;&#x8BA4;&#x5F00;&#x542F;&#x7684;&#xFF0C;&#x867D;&#x7136;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&quot;disable while typing&quot; &#x4F46;&#x662F;&#x603B;&#x6709;&#x8BEF;&#x89E6;&#x7684;&#x60C5;&#x51B5;&#xFF0C;xinput&#x53EF;&#x4EE5;&#x5728;&#x8F6F;&#x4EF6;&#x5C42;&#x62E6;&#x622A;&#x4E8B;&#x4EF6;&#x6765;&#x7981;&#x7528;&#x89E6;&#x6478;&#x677F;&#xFF0E;&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;google&#x5230;&#x4E86; &#x4E00;&#x4E2A;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x5916;&#x63A5;&#x9F20;&#x6807;&#x63D2;&#x62E8;&#x4E8B;&#x4EF6;&#x6765;&#x81EA;&#x52A8;&#x63A7;&#x5236;&#x89E6;&#x6478;&#x677F;&#x7684;&#x65B9;&#x6CD5;&#xFF0E;&#x6211;&#x7684;&#x684C;&#x9762;&#x73AF;&#x5883;&#x4E3A;debian8, gnome3. Conception &#x5148;&#x67E5;&#x770B;&#x8F93;&#x5165;&#x8BBE;&#x5907;&#xFF1A; bogwon@bogwon-desktop ~ $ xinput -list &#x23A1; Virtual core pointer id=2 [master pointer (3)] &#x239C; &#x21B3; Virtual core XTEST pointer id=4 [slave pointer (2)] &#x239C; &#x21B3; USB Optical Mouse id=14 [slave pointer (2)] &#x23A3; Virtual core keyboard id=3 [master keyboard (2)] &#x21B3; Virtual core XTEST keyboard id=5 [slave keyboard (3)] &#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x7535;&#x8111;&#x7684;pointer(&#x9F20;&#x6807;)&#x6709;&#x4E24;&#x4E2A;&#xFF1A; Virtual core XTEST pointer id=4 USB Optical Mouse id=14 &#x8FD9;&#x4E2A; USB Optical Mouse &#x5C31;&#x662F;&#x5916;&#x63A5;&#x9F20;&#x6807;&#x5566;, &#x6211;&#x4EEC;&#x8981;&#x627E;&#x7684;&#x81EA;&#x7136;&#x5C31;&#x662F; Virtual core XTEST poin &#x4ED6;&#x7684; id=4 . &#x73B0;&#x5728;&#x7528;xinput list-props&#x6765;&#x770B;&#x5B83;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;.&#x3000;=&#x53EF;&#x4EE5;&#x7528;&#x540D;&#x5B57;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x7528;id= bogwon@bogwon-desktop ~ $ xinput list-props 4 Device &apos;ETPS/2 Elantech Touchpad&apos;: Device Enabled (135): 1 Coordinate Transformation Matrix (137): 1.000000, 0.000000, ... ... &#x6CE8;&#x610F;&#x770B; Device Enabled (135): 1 &#x8868;&#x793A;&#x89E6;&#x6478;&#x677F;&#x662F;&#x88AB;&#x542F;&#x7528;&#x7684; &#x8BD5;&#x8BD5;&#x7981;&#x7528;&#x5B83;&#xFF1A; //&#x8FD9;&#x4E24;&#x6761;&#x547D;&#x4EE4;&#x662F;&#x4E00;&#x4E2A;&#x610F;&#x601D; bogwon@bogwon-desktop ~ $ xinput set-prop 4 &apos;Device Enabled&apos; 0 #&#x901A;&#x8FC7;&#x8BBE;&#x5907;&#x7F16;&#x53F7;+&#x5C5E;&#x6027;&#x540D;&#x7981;&#x7528;&#x89E6;&#x6478;&#x677F; bogwon@bogwon-desktop ~ $ xinput set-prop 4 135 0 #&#x901A;&#x8FC7;&#x8BBE;&#x5907;&#x7F16;&#x53F7;+&#x5C5E;&#x6027;&#x7F16;&#x53F7;&#x6765;&#x8BBE;&#x7F6E; //&#x67E5;&#x770B;&#x73B0;&#x5728;&#x7684;&#x72B6;&#x6001; bogwon@bogwon-desktop ~ $ xinput list-props 4 Device &apos;ETPS/2 Elantech Touchpad&apos;: Device Enabled (135): 0 #&#x53D8;&#x6210;&#x4E86;0&#xFF0C;&#x8868;&#x793A;&#x7981;&#x7528; Coordinate Transformation Matrix (137): 1.000000, 0.000000, ... ... &#x73B0;&#x5728;&#x4F60;&#x7684;&#x89E6;&#x6478;&#x677F;&#x662F;&#x4E0D;&#x662F;&#x5DF2;&#x7ECF;&#x4E0D;&#x80FD;&#x7528;&#x4E86;. ^O^ Hacking TouchPad En/Disable with Mouse &#x8981;&#x8BA9;&#x89E6;&#x6478;&#x677F;&#x5728;&#x4EFB;&#x4F55;&#x65F6;&#x5019;&#x90FD;&#x53D7;&#x9F20;&#x6807;&#x63A7;&#x5236;&#xFF0C;&#x6709;&#x4E09;&#x4E2A;&#x65B9;&#x9762;&#x9700;&#x8981;&#x8003;&#x8651;&#xFF0E; &#x6240;&#x6709;&#x6D4B;&#x8BD5;&#x90FD;&#x662F;&#x4E00;&#x4E2A;&#x5916;&#x63A5;&#x9F20;&#x6807;&#x7684;&#x60C5;&#x51B5;,&#x7A77;&#x5C4C;&#x4E1D;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x9F20;&#x6807;&#x989D; gdm&#x767B;&#x9646;&#x9875;&#x9762; &#x5F00;&#x673A;&#x540E;(&#x8FDB;&#x5165;gdm&#x767B;&#x9646;&#x754C;&#x9762;&#x65F6;)&#x6839;&#x636E;&#x662F;&#x5426;&#x6709;&#x5916;&#x63A5;&#x9F20;&#x6807;&#x6765;&#x63A7;&#x5236;&#x4E00;&#x6B21;&#x89E6;&#x6478;&#x677F;&#x72B6;&#x6001;&#xFF0E; &#x65B9;&#x6CD5;&#x662F;&#x628A;&#x4E0B;&#x9762;&#x90E8;&#x5206;&#x4EE3;&#x7801;&#x6DFB;&#x52A0;&#x5230; /etc/gdm/Init/Default &#x7684; &apos;exit 0&apos; &#x4E4B;&#x524D;&#xFF0E; #disable touchpad if more than one mouse is available if [ `ls -d /sys/class/input/mouse* | wc -l` -gt 1 ]; then /usr/bin/xinput --set-prop ETPS/2\\ Elantech\\ Touchpad Device\\ Enabled 0 fi &#x8FD9;&#x4E00;&#x53E5;&#x8981;&#x6CE8;&#x610F;&#xFF1A;if [ `ls -d /sys/class/input/mouse* | wc -l` -gt 1 ]; then &#x61C2;&#x70B9;shell-script&#x7684;&#x5C31;&#x80FD;&#x770B;&#x61C2;&#x4E86;&#xFF0C;ls &#x5217;&#x51FA;&#x4E86;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;mouse; wc -l&#x662F;&#x6570;&#x884C;&#x6570;. &#x4E5F;&#x5C31;&#x662F;&#x3000;if [ &#x884C;&#x6570;(&#x9F20;&#x6807;&#x6570;) great than 1 ]; then gnome3&#x684C;&#x9762; &#x7531;gmd&#x8FDB;&#x5165;gnome3&#x540E;&#x53D1;&#x73B0;&#x89E6;&#x6478;&#x677F;&#x5C45;&#x7136;&#x53C8;&#x80FD;&#x7528;&#x4E86;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x662F;&#x7528;autostart&#x81EA;&#x542F;&#x52A8;&#x9879;&#xFF0E; &#x5148;&#x521B;&#x5EFA;~/disableTouchpad.sh &#x5185;&#x5BB9;&#x5982;&#x4E0B;: #!/bin/bash if [ `ls -d /sys/class/input/mouse* | wc -l` -gt 1 ]; then /usr/bin/xinput --set-prop &apos;ETPS/2 Elantech Touchpad&apos; &apos;Device Enabled&apos; 0 fi &#x518D;&#x5728;~/.config/autostart/&#x4E0B;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x542F;&#x52A8;&#x5668;disableTouchpad.desktop&#x6587;&#x4EF6;&#xFF0C;&#x5185;&#x5BB9;&#x5982;&#x4E0B; [Desktop Entry] Type=Application Exec=/path/to/disableTouchpad.sh Hidden=yes NoDisplay=yes X-GNOME-Autostart-enabled=true Name[zh_CN]=touchpad disable Name=touchpad disable Comment[zh_CN]=&#x7981;&#x7528;&#x89E6;&#x6478;&#x677F; Comment=&#x7981;&#x7528;&#x89E6;&#x6478;&#x677F; &#x7528;&#x9F20;&#x6807;&#x63D2;&#x62E8;&#x4E8B;&#x4EF6;&#x6765;&#x7981;/&#x542F;&#x7528;&#x89E6;&#x6478;&#x677F; &#x5728;&#x7CFB;&#x7EDF;&#x89C4;&#x5219;&#x4E2D;&#x4E3A;&#x89E6;&#x6478;&#x677F;&#x6DFB;&#x52A0;&#x4E00;&#x6761;&#x89C4;&#x5219;&#x547D;&#x540D;&#x4E3A; /etc/udev/rules.d/61-touchpad.rules # 61-touchpad.rules # disable PS/2 touchpad on DISPLAY :0 if a mouse is added to the system ACTION==&quot;add&quot;, SUBSYSTEM==&quot;input&quot;, ENV{ID_INPUT_MOUSE}==&quot;1&quot;, \\ RUN+=&quot;/bin/sh -c &apos;DISPLAY=:0 /usr/bin/xinput --set-prop \\ ETPS/2\\ Elantech\\ Touchpad Device\\ Enabled 0&apos;&quot; # enable PS/2 touchpad on DISPLAY :0 if a mouse is removed from the system ACTION==&quot;remove&quot;, SUBSYSTEM==&quot;input&quot;, ENV{ID_INPUT_MOUSE}==&quot;1&quot;, \\ RUN+=&quot;/bin/sh -c &apos;DISPLAY=:0 /usr/bin/xinput --set-prop \\ ETPS/2\\ Elantech\\ Touchpad Device\\ Enabled 1&apos;&quot; &#x8FD9;&#x4E2A;&#x811A;&#x672C;&#x5B9A;&#x4E49;&#x4E86;&#x4E24;&#x4E2A;action, &#x5206;&#x522B;&#x5728;&#x5916;&#x63A5;&#x9F20;&#x6807;&quot;add&quot;&#x548C;&#xFF02;remove&quot;&#x65F6;&#xFF0C;&#x6267;&#x884C;RUN&#x53C2;&#x6570;&#x540E;xinput &#x547D;&#x4EE4;&#x6765;&#x7BA1;&#x7406;&#x89E6;&#x6478;&#x677F;&#xFF0E;&#x60F3;&#x4E86;&#x89E3;&#x66F4;&#x591A;&#x53EF;&#x4EE5;&#x770B;rules.d&#x7684;&#x5B98;&#x65B9;&#x6587;&#x6863;&#xFF0E; &#x7CFB;&#x7EDF;&#x4ECE;&#x4F11;&#x7720;&#x4E2D;&#x5524;&#x9192;&#x65F6;&#x5237;&#x65B0;&#x89E6;&#x6478;&#x677F;&#x72B6;&#x6001; &#x5C06;&#x4E0B;&#x9762;&#x90E8;&#x5206;&#x4EE3;&#x7801;&#x4FDD;&#x5B58;&#x4E3A; /etc/pm/sleep.d/99touchpad #!/bin/sh # disable touchpad if more than one mouse is available disable_touchpad() { /bin/sh -c &apos;DISPLAY=:0 /usr/bin/xinput --set-prop PS/2\\ Generic\\ TouchPad Device\\ Enabled 0&apos; } case &quot;$1&quot; in thaw|resume) if [ `ls -d /sys/class/input/mouse* | wc -l` -gt 1 ]; then disable_touchpad fi ;; *) exit $NA ;; esac Done ! &#x73B0;&#x5728;&#x90FD;&#x641E;&#x5B9A;&#x4E86;&#xFF0C;&#x91CD;&#x542F;&#x8BD5;&#x8BD5;&#x770B;&#x770B;&#x6709;&#x6CA1;&#x6709;&#x4EC0;&#x4E48;bug&#x5427;&#xFF0E;","tags":[{"name":"linux","slug":"linux","permalink":"http://maple-zyf.github.io/tags/linux/"},{"name":"gnome3","slug":"gnome3","permalink":"http://maple-zyf.github.io/tags/gnome3/"}]},{"title":"Hello,orgmode","date":"2015-11-15T09:00:00.000Z","path":"2015/11/15/first/","text":"Table of Contents Orgmode Why org Orgmode Why org console.log(&apos;hello&apos;);","tags":[{"name":"emacs","slug":"emacs","permalink":"http://maple-zyf.github.io/tags/emacs/"},{"name":"orgmode","slug":"orgmode","permalink":"http://maple-zyf.github.io/tags/orgmode/"},{"name":"hexo","slug":"hexo","permalink":"http://maple-zyf.github.io/tags/hexo/"}]}]